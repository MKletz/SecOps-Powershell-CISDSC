"SectionNum","RecommendationNum","Title","DSCTitle","Description","RemediationProcedure","AuditProcedure","Level","RecommendationVersioned","SectionVersioned","TopLevelSection","ResourceParameters","DSCTextBlock","DSCConfigParameter","NeedsParameter"
"1.2","1.2.3","(L1) Ensure 'Allow Administrator account lockout' is set to 'Enabled'","1.2.3 - (L1) Ensure Allow Administrator account lockout is set to Enabled","This policy setting determines whether the built-in Administrator account is subject to the following Account Lockout Policy settings: _Account lockout duration_, _Account lockout threshold_, and _Reset account lockout counter_. By default, this account is excluded from the account lockout controls and will never be locked out with repeated bad password attempts. 

The recommended state for this setting is: `Enabled`.

**Note:** This setting applies only to OSes patched as of October 11, 2022 (see [MS KB5020282](https://support.microsoft.com/en-us/topic/kb5020282-account-lockout-available-for-built-in-local-administrators-bce45c4d-f28d-43ad-b6fe-70156cb2dc00)).","To establish the recommended configuration via GP, set the following UI path to `Enabled`:

```
Computer Configuration\Policies\Windows Settings\Security Settings\Account Policies\Account Lockout Policies\Allow Administrator account lockout
```","Navigate to the UI Path articulated in the Remediation section and confirm it is set as prescribed.","LevelOne","1.2.3","1.2","1",,,,"False"
"18.9.5","18.9.5.7","(L1) Ensure 'Turn On Virtualization Based Security: Kernel-mode Hardware-enforced Stack Protection' is set to 'Enabled: Enabled in enforcement mode'","18.9.5.7 - (L1) Ensure Turn On Virtualization Based Security Kernel-mode Hardware-enforced Stack Protection is set to Enabled Enabled in enforcement mode","This policy setting enables Hardware-enforced Stack Protection for kernel-mode code. Kernel-mode data stacks are hardened with hardware-based shadow stacks, which store intended return address targets to ensure that program control flow is not tampered.

The recommended state for this setting is: `Enabled: Enabled in enforcement mode`.

**Note:** Virtualization Based Security (VBS) requires a 64-bit version of Windows with Secure Boot enabled, which in turn requires that Windows was installed with a UEFI BIOS configuration, not a Legacy BIOS configuration. In addition, if running Windows on a virtual machine, the hardware-assisted CPU virtualization feature (Intel VT-x or AMD-V) must be exposed by the host to the guest VM.

More information on system requirements for this feature can be found at [Windows Defender Credential Guard Requirements (Windows 10) | Microsoft Docs](https://docs.microsoft.com/en-us/windows/security/identity-protection/credential-guard/credential-guard-requirements)

**Note #2:** This specific security feature of VBS is only compatible with Windows 11 Release 22H2 (and newer).

**Note #3:** Only Intel CPUs from Tiger Lake and beyond or AMD CPUs Zen3 and beyond (both were release in fall 2020) are compatible with this security feature. 

**Note #4:** Credential Guard and Device Guard are not currently supported when using Azure IaaS VMs.","To establish the recommended configuration via GP, set the following UI path to `Enabled: Enabled in enforcement mode`

```
Computer Configuration\Policies\Administrative Templates\System\Device Guard\Turn On Virtualization Based Security: Kernel-mode Hardware-enforced Stack Protection
```

**Note:** This Group Policy path may not exist by default. It is provided by the Group Policy template `DeviceGuard.admx/adml` that is included with the Microsoft Windows 11 Release 22H2 Administrative Templates (and newer).","Navigate to the UI Path articulated in the Remediation section and confirm it is set as prescribed. This group policy setting is backed by the following registry location:

```
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\DeviceGuard:ConfigureKernelShadowStacksLaunch
```","LevelOne","18.9.5.7","18.9.5","18",,,,"False"
"18.3","18.3.1","(L1) Ensure LAPS AdmPwd GPO Extension / CSE is installed","18.3.1 - (L1) Ensure LAPS AdmPwd GPO Extension  CSE is installed","In May 2015, Microsoft released the Local Administrator Password Solution (LAPS) tool, which is free and supported software that allows an organization to automatically set randomized and unique local Administrator account passwords on domain-attached workstations and Member Servers. The passwords are stored in a confidential attribute of the domain computer account and can be retrieved from Active Directory by approved Sysadmins when needed.

The LAPS tool requires a small Active Directory Schema update in order to implement, as well as installation of a Group Policy Client Side Extension (CSE) on targeted computers. Please see the LAPS documentation for details.

LAPS supports Windows Vista or newer workstation OSes, and Server 2003 or newer server OSes. LAPS does not support standalone computers - they must be joined to a domain.

**Note:** Organizations that utilize 3rd-party commercial software to manage unique & complex local Administrator passwords on domain members may opt to disregard these LAPS recommendations.

**Note #2:** LAPS is only designed to manage _local_ Administrator passwords, and is therefore not recommended (or supported) for use directly on Domain Controllers, which do not have a traditional local Administrator account. We strongly encourage you to only deploy the LAPS CSE and LAPS GPO settings to member servers and workstations.","In order to utilize LAPS, a minor Active Directory Schema update is required, and a Group Policy Client Side Extension (CSE) must be installed on each managed computer. When LAPS is installed, the file `AdmPwd.dll` must be present in the following location and registered in Windows (the LAPS AdmPwd GPO Extension / CSE installation does this for you):

 ```
C:\Program Files\LAPS\CSE\AdmPwd.dll
```","The LAPS AdmPwd GPO Extension / CSE can be verified to be installed by the presence of the following registry value:

 ```
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\GPExtensions\{D76B9641-3288-4f75-942D-087DE603E3EA}:DllName
```","LevelOne","18.3.1","18.3","18",,,,"False"
"18.9.25","18.9.25.2","(L1) Ensure 'Configures LSASS to run as a protected process' is set to 'Enabled: Enabled with UEFI Lock'","18.9.25.2 - (L1) Ensure Configures LSASS to run as a protected process is set to Enabled Enabled with UEFI Lock","This policy setting controls whether the Local Security Authority Subservice Service (LSASS) runs in protected mode and also has the option to lock in protected mode with Unified Extensible Firmware Interface (UEFI). The Local Security Authority (LSA), which includes the LSASS process, validates users for local and remote sign-ins and enforces local security policies.

The recommended state for this setting is: `Enabled: Enabled with UEFI Lock`.

**Note:** This additional protection to prevent reading memory and code injection by non-protected processes is supported by Windows 8.1 (and newer).","To establish the recommended configuration via GP, set the following UI path to `Enabled: Enabled with UEFI Lock`:

```
Computer Configuration\Policies\Administrative Templates\System\Local Security Authority\Configures LSASS to run as a protected process
```","Navigate to the UI Path articulated in the Remediation section and confirm it is set as prescribed. This group policy setting is backed by the following registry location:

```
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa:ConfigureLsaProtectedProcess
```","LevelOne","18.9.25.2","18.9.25","18",,,,"False"
"18.9.7.1","18.9.7.1.5","(BL) Ensure 'Prevent installation of devices using drivers that match these device setup classes: Prevent installation of devices using drivers for these device setup' is set to 'IEEE 1394 device setup classes'","18.9.7.1.5 - (BL) Ensure Prevent installation of devices using drivers that match these device setup classes Prevent installation of devices using drivers for these ","This policy setting allows you to specify a list of device setup class globally unique identifiers (GUIDs) for device drivers that Windows is prevented from installing. This policy setting takes precedence over any other policy setting that allows Windows to install a device.

If you enable this policy setting, Windows is prevented from installing or updating device drivers whose device setup class GUIDs appear in the list you create. If you enable this policy setting on a remote desktop server, the policy setting affects redirection of the specified devices from a remote desktop client to the remote desktop server.

If you disable or do not configure this policy setting, Windows can install and update devices as allowed or prevented by other policy settings.

Here are the four entries we recommend and what they translate to:

- `{d48179be-ec20-11d1-b6b8-00c04fa372a7}` - IEEE 1394 devices that support the SBP2 Protocol Class
- `{7ebefbc0-3200-11d2-b4c2-00a0C9697d07}` - IEEE 1394 devices that support the IEC-61883 Protocol Class
- `{c06ff265-ae09-48f0-812c-16753d7cba83}` - IEEE 1394 devices that support the AVC Protocol Class
- `{6bdd1fc1-810f-11d0-bec7-08002be2092f}` - IEEE 1394 Host Bus Controller Class

The full list of system-defined device setup classes available in Windows is here: [System-Defined Device Setup Classes Available to Vendors | Microsoft Docs](https://docs.microsoft.com/en-us/windows-hardware/drivers/install/system-defined-device-setup-classes-available-to-vendors)

The recommended state for this setting is: `{d48179be-ec20-11d1-b6b8-00c04fa372a7}`, `{7ebefbc0-3200-11d2-b4c2-00a0C9697d07}`, `{c06ff265-ae09-48f0-812c-16753d7cba83}`, and `{6bdd1fc1-810f-11d0-bec7-08002be2092f}`

**Note:** IEEE 1394 has also been known/branded as _FireWire_ (by Apple), _i.LINK_ (by Sony) and _Lynx_ (by Texas Instruments).","To establish the recommended configuration via GP, set the following UI path to `Enabled`, and add `{d48179be-ec20-11d1-b6b8-00c04fa372a7}`, `{7ebefbc0-3200-11d2-b4c2-00a0C9697d07}`, `{c06ff265-ae09-48f0-812c-16753d7cba83}`, and `{6bdd1fc1-810f-11d0-bec7-08002be2092f}` to the device setup classes list:

```
Computer Configuration\Policies\Administrative Templates\System\Device Installation\Device Installation Restrictions\Prevent installation of devices using drivers that match these device setup classes
```

**Note:** This Group Policy path is provided by the Group Policy template `DeviceInstallation.admx/adml` that is included with all versions of the Microsoft Windows Administrative Templates.","Navigate to the UI Path articulated in the Remediation section and confirm it is set as prescribed. This group policy setting is backed by the following registry location:

```
HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\DeviceInstall\Restrictions\DenyDeviceClasses:<numeric value>
```","BitLocker","18.9.7.15","18.9.7.1","18",,,,"False"
"18.7","18.7.8","(L1) Ensure 'Limits print driver installation to Administrators' is set to 'Enabled'","18.7.8 - (L1) Ensure Limits print driver installation to Administrators is set to Enabled","This policy setting controls whether users who aren't Administrators can install print drivers on the system.

The recommended state for this setting is: `Enabled`.

**Note:** On August 10, 2021, Microsoft announced a [Point and Print Default Behavior Change](https://msrc-blog.microsoft.com/2021/08/10/point-and-print-default-behavior-change/) which modifies the default Point and Print driver installation and update behavior to require Administrator privileges. This is documented in [KB5005652—Manage new Point and Print default driver installation behavior (CVE-2021-34481)](https://support.microsoft.com/en-gb/topic/kb5005652-manage-new-point-and-print-default-driver-installation-behavior-cve-2021-34481-873642bf-2634-49c5-a23b-6d8e9a302872).","To establish the recommended configuration via GP, set the following UI path to `Enabled`.

```
Computer Configuration\Policies\Administrative Templates\MS Security Guide\Limits print driver installation to Administrators
```

**Note:** This Group Policy path does not exist by default. An additional Group Policy template `SecGuide.admx/adml` is required - it is available from Microsoft at this [link](https://www.microsoft.com/en-us/download/details.aspx?id=55319).","Navigate to the UI Path articulated in the Remediation section and confirm it is set as prescribed. This group policy setting is backed by the following registry location:

```
HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows NT\Printers\PointAndPrint:RestrictDriverInstallationToAdministrators 
```","LevelOne","18.7.8","18.7","18",,,,"False"
